# Stripeå•†å“ã‚«ã‚¿ãƒ­ã‚°ä½œæˆã‚¬ã‚¤ãƒ‰

## æ¦‚è¦
Divergeã®3æ®µéšã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ï¼ˆFree, Plus, Proï¼‰ã‚’Stripe Dashboardã§è¨­å®šã—ã¾ã™ã€‚

---

## å‰ææ¡ä»¶
- Stripeã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆæ¸ˆã¿
- ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰/æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰ã‚’ç¢ºèª

---

## ğŸ“¦ ä½œæˆã™ã‚‹å•†å“ãƒ»ä¾¡æ ¼

### 1. Free Plan
**å•†å“å**: Diverge Free Plan
**ä¾¡æ ¼**: $0
**èª¬æ˜**: Basic features with 5 AI models, 500K tokens/month

**ç‰¹å¾´**:
- 5 AI models
- 500,000 tokens/month
- 3 sessions/month
- 10 web searches/month

---

### 2. Plus Plan

#### Plus Monthly
**å•†å“å**: Diverge Plus Plan
**è«‹æ±‚é–“éš”**: Monthly
**ä¾¡æ ¼**: $20/æœˆ
**èª¬æ˜**: Full access to all AI models with 4M tokens/month

**ç‰¹å¾´**:
- All AI models
- 4,000,000 tokens/month
- Unlimited sessions
- 200 web searches/month
- Priority support

#### Plus Yearly
**å•†å“å**: Diverge Plus Plan (Annual)
**è«‹æ±‚é–“éš”**: Yearly
**ä¾¡æ ¼**: $200/å¹´ ($16.67/æœˆç›¸å½“ã€2ãƒ¶æœˆç„¡æ–™)
**èª¬æ˜**: Full access to all AI models with 4M tokens/month (save 2 months!)

**ç‰¹å¾´**: Monthlyç‰ˆã¨åŒã˜ + å¹´é–“2ãƒ¶æœˆåˆ†ç„¡æ–™

---

### 3. Pro Plan

#### Pro Monthly
**å•†å“å**: Diverge Pro Plan
**è«‹æ±‚é–“éš”**: Monthly
**ä¾¡æ ¼**: $50/æœˆ
**èª¬æ˜**: Unlimited tokens, web searches, and advanced features

**ç‰¹å¾´**:
- All AI models
- 15,000,000 tokens/month
- Unlimited sessions
- Unlimited web searches
- Priority support
- API access (10K calls/month)
- Advanced analytics

#### Pro Yearly
**å•†å“å**: Diverge Pro Plan (Annual)
**è«‹æ±‚é–“éš”**: Yearly
**ä¾¡æ ¼**: $500/å¹´ ($41.67/æœˆç›¸å½“ã€2ãƒ¶æœˆç„¡æ–™)
**èª¬æ˜**: Unlimited tokens, web searches, and advanced features (save 2 months!)

**ç‰¹å¾´**: Monthlyç‰ˆã¨åŒã˜ + å¹´é–“2ãƒ¶æœˆåˆ†ç„¡æ–™

---

## ğŸ› ï¸ Stripeãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ä½œæˆæ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ—1: Stripeãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒ­ã‚°ã‚¤ãƒ³
1. https://dashboard.stripe.com ã«ã‚¢ã‚¯ã‚»ã‚¹
2. å³ä¸Šã®ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ã§ **ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰** ã¾ãŸã¯ **æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰** ã‚’é¸æŠ

### ã‚¹ãƒ†ãƒƒãƒ—2: å•†å“ã‚’ä½œæˆ

#### Plus Monthly ã®ä¾‹

1. **å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼** â†’ **å•†å“ã‚«ã‚¿ãƒ­ã‚° (Product catalog)**
2. **+ å•†å“ã‚’è¿½åŠ  (+ Add product)** ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ä»¥ä¸‹ã‚’å…¥åŠ›ï¼š

   **å•†å“æƒ…å ±**:
   - åå‰: `Diverge Plus Plan`
   - èª¬æ˜: `Full access to all AI models with 4M tokens/month`
   - ç”»åƒ: ï¼ˆä»»æ„ï¼‰ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãƒ­ã‚´ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

   **æ–™é‡‘æƒ…å ±**:
   - æ–™é‡‘ãƒ¢ãƒ‡ãƒ«: `Standard pricing`
   - ä¾¡æ ¼: `20` USD
   - è«‹æ±‚æœŸé–“: `Monthly`
   - è«‹æ±‚æ–¹æ³•: `Charge automatically`

   **è¿½åŠ ã‚ªãƒ—ã‚·ãƒ§ãƒ³**:
   - ç„¡æ–™ãƒˆãƒ©ã‚¤ã‚¢ãƒ«: ãªã—ï¼ˆã¾ãŸã¯å¸Œæœ›ã™ã‚‹æœŸé–“ï¼‰
   - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆä»»æ„ï¼‰:
     - `plan_id`: `plus`
     - `tokens_limit`: `4000000`
     - `sessions_limit`: `-1`
     - `web_searches_limit`: `200`

4. **å•†å“ã‚’ä¿å­˜ (Save product)** ã‚’ã‚¯ãƒªãƒƒã‚¯
5. **Price ID ã‚’ã‚³ãƒ”ãƒ¼** (ä¾‹: `price_1ABC123xyz...`)

### ã‚¹ãƒ†ãƒƒãƒ—3: æ®‹ã‚Šã®å•†å“ã‚’ä½œæˆ

åŒæ§˜ã®æ‰‹é †ã§ä»¥ä¸‹ã‚’ä½œæˆï¼š
- Plus Yearly ($200/year)
- Pro Monthly ($50/month)
- Pro Yearly ($500/year)

**æ³¨æ„**: Freeãƒ—ãƒ©ãƒ³ã¯å•†å“ä½œæˆä¸è¦ï¼ˆStripeæ±ºæ¸ˆãªã—ï¼‰

---

## ğŸ“‹ ä½œæˆã™ã‚‹ Price ID ä¸€è¦§è¡¨

ä½œæˆå¾Œã€ä»¥ä¸‹ã®è¡¨ã‚’åŸ‹ã‚ã¦ãã ã•ã„ï¼š

| ãƒ—ãƒ©ãƒ³ | è«‹æ±‚é–“éš” | ä¾¡æ ¼ | Price ID |
|--------|----------|------|----------|
| Plus | Monthly | $20 | `price_________________` |
| Plus | Yearly | $200 | `price_________________` |
| Pro | Monthly | $50 | `price_________________` |
| Pro | Yearly | $500 | `price_________________` |

---

## ğŸ”§ ã‚³ãƒ¼ãƒ‰ã¸ã®åæ˜ æ–¹æ³•

ä½œæˆã—ãŸPrice IDã‚’å–å¾—ã—ãŸã‚‰ã€ç§ã«æ•™ãˆã¦ãã ã•ã„ã€‚
ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•æ›´æ–°ã—ã¾ã™ã€‚

å¿…è¦ãªæƒ…å ±ï¼š
```
Plus Monthly: price_xxxxx
Plus Yearly: price_yyyyy
Pro Monthly: price_zzzzz
Pro Yearly: price_wwwww
```

---

## ğŸ” Webhookè¨­å®š

### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ 

1. **Stripe Dashboard** â†’ **é–‹ç™ºè€… (Developers)** â†’ **Webhooks**
2. **+ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ  (+ Add endpoint)** ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURL: `https://yourdomain.com/api/stripe/webhook`
4. ç›£è¦–ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’é¸æŠ:
   - `checkout.session.completed`
   - `customer.subscription.created`
   - `customer.subscription.updated`
   - `customer.subscription.deleted`
   - `invoice.payment_succeeded`
   - `invoice.payment_failed`
5. **ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ  (Add endpoint)** ã‚’ã‚¯ãƒªãƒƒã‚¯
6. **ç½²åã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ (Signing secret)** ã‚’ã‚³ãƒ”ãƒ¼
7. ç’°å¢ƒå¤‰æ•° `STRIPE_WEBHOOK_SECRET` ã«è¨­å®š

---

## âœ… å‹•ä½œç¢ºèªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰
- [ ] Plus Monthly ã®å•†å“ãƒ»ä¾¡æ ¼ãŒä½œæˆã•ã‚ŒãŸ
- [ ] Plus Yearly ã®å•†å“ãƒ»ä¾¡æ ¼ãŒä½œæˆã•ã‚ŒãŸ
- [ ] Pro Monthly ã®å•†å“ãƒ»ä¾¡æ ¼ãŒä½œæˆã•ã‚ŒãŸ
- [ ] Pro Yearly ã®å•†å“ãƒ»ä¾¡æ ¼ãŒä½œæˆã•ã‚ŒãŸ
- [ ] Price ID ãŒã™ã¹ã¦ã‚³ãƒ”ãƒ¼ã•ã‚ŒãŸ

---

## ğŸ“ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. Stripeãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§4ã¤ã®å•†å“ã‚’ä½œæˆ
2. 4ã¤ã® Price ID ã‚’ã‚³ãƒ”ãƒ¼
3. ç§ã« Price ID ã‚’æ•™ãˆã¦ãã ã•ã„ â†’ ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•æ›´æ–°ã—ã¾ã™

---

## ğŸ”— å‚è€ƒãƒªãƒ³ã‚¯
- [Stripe å•†å“ãƒ»ä¾¡æ ¼ã®ä½œæˆ](https://stripe.com/docs/products-prices/overview)
- [Stripe Webhook](https://stripe.com/docs/webhooks)
- [Stripe Testing](https://stripe.com/docs/testing)
